---
title: "Burden of Risk Behaviours"
output: html_notebook
---



```{r "setup", include=FALSE}
# Need to set up the environment
workingDir <- "/home/luke/Documents/E_FEM_clean/E_FEM"
knitr::opts_knit$set(root.dir = workingDir)

require(haven)
require(dplyr)
require(tidyr)
require(ggplot2)
```


# Baseline Plots (Cohort)

```{r}

cohort <- read_dta('output/ELSA_cohort/ELSA_cohort_summary.dta')

# Generate age var
cohort$age <- (cohort$year - 2012) + 50

# Survival curve
cohort$survival <- cohort$m_endpop_all / cohort$m_endpop_all[1]

# Now plot all survival curves together
ggplot(cohort, aes(x=age, y=survival)) +
        geom_line(col='black', size=0.3) +
        labs(title='Cohort Survival', y='Survival', x='Age')
# Smoking variables and chronic diseases
ggplot(cohort, aes(x=age, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Age')
ggplot(cohort, aes(x=age, y=n_smoke_start_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Smoke Start', y='# Started Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Smoking (Cohort)', y='Prevalence of Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Lung Disease (Cohort)', y='Prevalence of Lung Disease', x='Age')
ggplot(cohort, aes(x=age, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Cancer (Cohort)', y='Prevalence of Cancer', x='Age')
ggplot(cohort, aes(x=age, y=p_drink_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Drink (Cohort)', y='Prevalence of Drink', x='Age')
ggplot(cohort, aes(x=age, y=p_stroke_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Stroke (Cohort)', y='Prevalence of Drink', x='Age')


```


# Baseline plots (Population)

```{r}

pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')

# Plot Average age at death
ggplot(pop, aes(x=year, y=d_age_all)) +
        geom_line(col='black', size=0.3) +
        geom_smooth(method="auto", se=FALSE, fullrange=FALSE, level=0.95) +
        labs(title='Average Age at Death', y='Age', x='Year')
# Smoking variables and chronic diseases
ggplot(pop, aes(x=year, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Year')
ggplot(pop, aes(x=year, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Smoking', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Lung Disease', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of Cancer', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_drink_all)) +
        geom_line(col='black', size=0.3) +
        geom_smooth(method="auto", se=FALSE, fullrange=FALSE, level=0.95) +
        labs(title='Prevalence of Drink', y='Proportion of Total Pop.', x='Year')

ggplot(pop, aes(x=year, y=p_hibpe_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of HBP', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_hibpe_drinkd1)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of HBP in teetotalers', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_hibpe_drinkd2)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of HBP in low drinkers', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_hibpe_drinkd3)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of HBP in moderate drinkers', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_hibpe_drinkd4)) +
        geom_line(col='black', size=0.3) +
        labs(title='Prevalence of HBP in heavy drinkers', y='Proportion of Total Pop.', x='Year')

ggplot(pop, aes(x=year, y=a_bmi_all)) +
        geom_line(col='black', size=0.3) +
        labs(title='Average BMI', y='BMI', x='Year')

ggplot(pop, aes(x=year, y=a_adlstat_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(col='red', size=0.3, aes(x=year, y=a_adlstat_drinkd1, color="No Drinking")) +
        geom_line(col='blue', size=0.3, aes(x=year, y=a_adlstat_drinkd2)) +
        geom_line(col='dark green', size=0.3, aes(x=year, y=a_adlstat_drinkd3)) +
        geom_line(col='orange', size=0.3, aes(x=year, y=a_adlstat_drinkd4)) +
        labs(title='Average level of Disability', y='Disability Level', x='Year')

```

# Show differences within drinkers and exercisers

```{r}

pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')

colours <- c("Total Population" = "black", "No Drinking" = "red", "Light Drinker" = "blue", "Moderate Drinker" = "Dark Green", "Heavy Drinker" = "orange")

ggplot(pop, aes(x=year, y=p_hearte_all)) +
        geom_line(col='black', size=0.5) +
        labs(title='Prevalence of Heart Disease', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_hearte_all)) +
        geom_line(col='black', size=0.5, aes(x=year, y=p_hearte_all, color="Total Population")) +
        geom_line(col='red', size=0.3, aes(x=year, y=p_hearte_drinkd1, color="No Drinking")) +
        labs(title='Prevalence of Heart Disease', y='Proportion of Total Pop.', x='Year', color="Legend") +
        scale_color_manual(values = colours, labels = c("Total Population", "No Drinking"))
ggplot(pop, aes(x=year, y=p_hearte_all)) +
        geom_line(col='black', size=0.5) +
        geom_line(col='red', size=0.3, aes(x=year, y=p_hearte_drinkd1, color="No Drinking")) +
        geom_line(col='blue', size=0.3, aes(x=year, y=p_hearte_drinkd2, color=group)) +
        labs(title='Prevalence of Heart Disease', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_hearte_all)) +
        geom_line(col='black', size=0.5) +
        geom_line(col='red', size=0.3, aes(x=year, y=p_hearte_drinkd1)) +
        geom_line(col='blue', size=0.3, aes(x=year, y=p_hearte_drinkd2)) +
        geom_line(col='dark green', size=0.3, aes(x=year, y=p_hearte_drinkd3)) +
        labs(title='Prevalence of Heart Disease', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=p_hearte_all)) +
        geom_line(col='black', size=0.5) +
        geom_line(col='red', size=0.3, aes(x=year, y=p_hearte_drinkd1)) +
        geom_line(col='blue', size=0.3, aes(x=year, y=p_hearte_drinkd2)) +
        geom_line(col='dark green', size=0.3, aes(x=year, y=p_hearte_drinkd3)) +
        geom_line(col='orange', size=0.3, aes(x=year, y=p_hearte_drinkd4)) +
        labs(title='Prevalence of Heart Disease', y='Proportion of Total Pop.', x='Year')

ggplot(pop, aes(x=year, y=p_asthmae_all)) +
        geom_line(col='black', size=0.5) +
        geom_line(col='red', size=0.3, aes(x=year, y=p_asthmae_drinkd1)) +
        geom_line(col='blue', size=0.3, aes(x=year, y=p_asthmae_drinkd2)) +
        geom_line(col='dark green', size=0.3, aes(x=year, y=p_asthmae_drinkd3)) +
        geom_line(col='orange', size=0.3, aes(x=year, y=p_asthmae_drinkd4)) +
        labs(title='Prevalence of Asthma', y='Proportion of Total Pop.', x='Year')

ggplot(pop, aes(x=year, y=p_diabe_all)) +
        geom_line(col='black', size=0.5) +
        geom_line(col='red', size=0.3, aes(x=year, y=p_diabe_drinkd1)) +
        geom_line(col='blue', size=0.3, aes(x=year, y=p_diabe_drinkd2)) +
        geom_line(col='dark green', size=0.3, aes(x=year, y=p_diabe_drinkd3)) +
        geom_line(col='orange', size=0.3, aes(x=year, y=p_diabe_drinkd4)) +
        labs(title='Prevalence of Diabetes', y='Proportion of Total Pop.', x='Year')

ggplot(pop, aes(x=year, y=p_diabe_all)) +
        geom_line(col='black', size=0.5) +
        geom_line(col='red', size=0.3, aes(x=year, y=p_diabe_exstat1)) +
        geom_line(col='blue', size=0.3, aes(x=year, y=p_diabe_exstat2)) +
        geom_line(col='dark green', size=0.3, aes(x=year, y=p_diabe_exstat3)) +
        labs(title='Prevalence of Diabetes', y='Proportion of Total Pop.', x='Year')

```

# Reshaping data before plotting for legend
```{r}

pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')

# Specify colour palette
colours <- c("Total Population" = "black", "No Alcohol" = "red", "Light Drinker" = "blue", "Moderate Drinker" = "Dark Green", "Heavy Drinker" = "orange")

pop_copy <- rename(pop, "Total Population" = p_hearte_all, "No Alcohol" = p_hearte_drinkd1, "Light Drinker" = p_hearte_drinkd2, "Moderate Drinker" = p_hearte_drinkd3, "Heavy Drinker" = p_hearte_drinkd4)

pop_gathered <- gather(pop_copy, key = Subpopulation, value = Rate, c("Total Population", "No Alcohol", "Light Drinker", "Moderate Drinker", "Heavy Drinker"))
#pop_gathered <- gather(pop_copy, key = Subpopulation, value = Rate, c("Total Population", "No Alcohol"))
#pop_gathered <- gather(pop_copy, key = Subpopulation, value = Rate, c("Total Population"))
#pop_gathered <- gather(pop_copy, key = Subpopulation, value = Rate, c("Total Population", "No Alcohol", "Light Drinker", "Moderate Drinker"))

pop_gathered$Subpopulation <- factor(pop_gathered$Subpopulation, levels = c("Total Population", "No Alcohol", "Light Drinker", "Moderate Drinker", "Heavy Drinker"))
#pop_gathered$Subpopulation <- factor(pop_gathered$Subpopulation, levels = c("Total Population", "No Alcohol"))
#pop_gathered$Subpopulation <- factor(pop_gathered$Subpopulation, levels = c("Total Population"))
#pop_gathered$Subpopulation <- factor(pop_gathered$Subpopulation, levels = c("Total Population", "No Alcohol", "Light Drinker", "Moderate Drinker"))

ggplot(pop_gathered, aes(x=year, y= Rate, group = Subpopulation, colour = Subpopulation)) + 
        geom_line() +
        labs(title='Heart Disease', 
             y='Proportion of Total Pop.', 
             x='Year') +
        scale_color_manual(name = "Subpopulation", labels=c("Total Population", "No Alcohol", "Light Drinker", "Moderate Drinker", "Heavy Drinker"), values = colours)

```



# Init no smoking interventions (cohort and pop)

```{r}

cohort <- read_dta('output/ELSA_cohort/ELSA_cohort_summary.dta')
initNoSmokeC <- read_dta('output/initNoSmokeC/initNoSmokeC_summary.dta')

# Generate age var
cohort$age <- (cohort$year - 2012) + 50
initNoSmokeC$age <- (cohort$year - 2012) + 50

# Survival curve
cohort$survival <- cohort$m_endpop_all / cohort$m_endpop_all[1]
initNoSmokeC$survival <- initNoSmokeC$m_endpop_all / initNoSmokeC$m_endpop_all[1]

# Now plot all survival curves together
ggplot(cohort, aes(x=age, y=survival)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeC, size=0.3, col='red') +
        labs(title='Cohort Survival Over Time', y='Survival', x='Age')
# Smoking variables and chronic diseases
ggplot(cohort, aes(x=age, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeC, size=0.3, col='red') +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeC, size=0.3, col='red') +
        labs(title='Prevalence of Smoking by Age', y='Prevalence of Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeC, size=0.3, col='red') +
        labs(title='Prevalence of Lung Disease by Age', y='Prevalence of Lung Disease', x='Age')
ggplot(cohort, aes(x=age, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeC, size=0.3, col='red') +
        labs(title='Prevalence of Cancer by Age', y='Prevalence of Cancer', x='Age')

```

```{r}

# Read in all the data
pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')
initNoSmokeP <- read_dta('output/initNoSmokeP/initNoSmokeP_summary.dta')

# Plot Average age at death
ggplot(pop, aes(x=year, y=d_age_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeP, size=0.3, col='red') +
        labs(title='Average Age at Death over Time', y='Average age at death', x='Year')
        
# Smoking variables and chronic diseases
ggplot(pop, aes(x=year, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeP, size=0.3, col='red') +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Year')
ggplot(pop, aes(x=year, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeP, size=0.3, col='red') +
        labs(title='Prevalence of Smoking', y='Prevalence of Smoking', x='Year')
ggplot(pop, aes(x=year, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeP, size=0.3, col='red') +
        labs(title='Prevalence of Lung Disease', y='Prevalence of Lung Disease', x='Year')
ggplot(pop, aes(x=year, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=initNoSmokeP, size=0.3, col='red') +
        labs(title='Prevalence of Cancer', y='Prevalence of Cancer', x='Year')

```

# Do some silly shit again to get a legend

```{r}

# Read in all the data
pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')
initNoSmokeP <- read_dta('output/initNoSmokeP/initNoSmokeP_summary.dta')

colours_smoke <- c("Baseline" = "black", "No Smoking" = "red")

pop_lunge <- select(pop, c(year, p_lunge_all))
noSmoke <- select(initNoSmokeP, c(year, p_lunge_all))

#combined <- merge(pop_lunge, noSmoke)
combined <- merge.data.frame(pop_lunge, noSmoke, by="year")
combined <- rename(combined, "Baseline" = p_lunge_all.x, "No Smoking" = p_lunge_all.y)

comb_gather <- gather(combined, key = Scenario, value = Rate, c("Baseline", "No Smoking"))


ggplot(comb_gather, aes(x=year, y= Rate, group = Scenario, colour = Scenario)) + 
        geom_line() +
        labs(title='Lung Disease', 
             y='Proportion of Total Pop.', 
             x='Year') +
        scale_color_manual(name = "Scenario", labels=c("Baseline", "No Smoking"), values = colours_smoke)

```




# Init no drinking interventions (cohort and pop)

```{r}

cohort <- read_dta('output/ELSA_cohort/ELSA_cohort_summary.dta')
noDrinkC <- read_dta('output/initNoDrinkC/initNoDrinkC_summary.dta')

# Generate age var
cohort$age <- (cohort$year - 2012) + 50
noDrinkC$age <- (cohort$year - 2012) + 50

# Survival curve
cohort$survival <- cohort$m_endpop_all / cohort$m_endpop_all[1]
noDrinkC$survival <- noDrinkC$m_endpop_all / noDrinkC$m_endpop_all[1]

# Now plot all survival curves together
ggplot(cohort, aes(x=age, y=survival)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Cohort Survival Over Time', y='Survival', x='Age')
ggplot(cohort, aes(x=age, y=p_drink_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Prevalence of Drink (Cohort)', y='Prevalence of Drink', x='Age')
ggplot(cohort, aes(x=age, y=a_bmi_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Average BMI by Age', y='Average BMI', x='Age')
ggplot(cohort, aes(x=age, y=p_diabe_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Prevalence of Diabetes by Age', y='Prevalence of Diabetes', x='Age')
ggplot(cohort, aes(x=age, y=p_hibpe_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Prevalence of Hypertension by Age', y='Prevalence of Hypertension', x='Age')
ggplot(cohort, aes(x=age, y=p_hearte_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Prevalence of Heart Disease by Age', y='Prevalence of Heart Disease', x='Age')
ggplot(cohort, aes(x=age, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Prevalence of Cancer by Age', y='Prevalence of Cancer', x='Age')
ggplot(cohort, aes(x=age, y=p_stroke_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Prevalence of Stroke by Age', y='Prevalence of Stroke', x='Age')
ggplot(cohort, aes(x=age, y=p_asthmae_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkC, size=0.3, col='red') +
        labs(title='Prevalence of Asthma by Age', y='Prevalence of Asthma', x='Age')

```

```{r}

pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')
noDrinkP <- read_dta('output/initNoDrinkP/initNoDrinkP_summary.dta')

# Now plot all survival curves together
ggplot(pop, aes(x=year, y=d_age_all)) +
        geom_line(col='black', size=0.3) +
        geom_smooth(method="auto", se=FALSE, fullrange=FALSE, level=0.95) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        geom_smooth(data=noDrinkP, method="auto", se=FALSE, fullrange=FALSE, level=0.95) +
        labs(title='Average Age at Death Over Time', y='Average Age at Death', x='Year')
ggplot(pop, aes(x=year, y=p_drink_all)) +
        geom_line(col='black', size=0.3) +
        geom_smooth(method="auto", se=FALSE, fullrange=FALSE, level=0.95) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        geom_smooth(data=noDrinkP, method="auto", se=FALSE, fullrange=FALSE, level=0.95) +
        labs(title='Prevalence of Drink', y='Proportion of Total Pop.', x='Year')
ggplot(pop, aes(x=year, y=a_bmi_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        labs(title='Average BMI Over Time', y='Average BMI', x='Year')
ggplot(pop, aes(x=year, y=p_diabe_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        labs(title='Prevalence of Diabetes Over Time', y='Prevalence of Diabetes', x='Year')
ggplot(pop, aes(x=year, y=p_hibpe_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        labs(title='Prevalence of Hypertension Over Time', y='Prevalence of Hypertension', x='Year')
ggplot(pop, aes(x=year, y=p_hearte_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        labs(title='Prevalence of Heart Disease Over Time', y='Prevalence of Heart Disease', x='Year')
ggplot(pop, aes(x=year, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        labs(title='Prevalence of Cancer Over Time', y='Prevalence of Cancer', x='Year')
ggplot(pop, aes(x=year, y=p_stroke_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        labs(title='Prevalence of Stroke Over Time', y='Prevalence of Stroke', x='Year')
ggplot(pop, aes(x=year, y=p_asthmae_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=noDrinkP, size=0.3, col='red') +
        labs(title='Prevalence of Asthma Over Time', y='Prevalence of Asthma', x='Year')

```
























































# No Smoking Scenario (Cohort)

```{r}

# Read in all the data
cohort <- read_dta('output/ELSA_cohort/ELSA_cohort_summary.dta')
no_smoke_C <- read_dta('output/CureSmoken_C/CureSmoken_C_summary.dta')

# Generate age var
cohort$age <- (cohort$year - 2012) + 50
no_smoke_C$age <- (cohort$year - 2012) + 50

# Survival curve
cohort$survival <- cohort$m_endpop_all / cohort$m_endpop_all[1]
no_smoke_C$survival <- no_smoke_C$m_endpop_all / no_smoke_C$m_endpop_all[1]

# Now plot all survival curves together
ggplot(cohort, aes(x=age, y=survival)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_C, size=0.3, col='green') +
        labs(title='Cohort Survival Over Time', y='Survival', x='Age')
# Smoking variables and chronic diseases
ggplot(cohort, aes(x=age, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_C, size=0.3, col='green') +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_C, size=0.3, col='green') +
        labs(title='Prevalence of Smoking by Age', y='Prevalence of Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_C, size=0.3, col='green') +
        labs(title='Prevalence of Lung Disease by Age', y='Prevalence of Lung Disease', x='Age')
ggplot(cohort, aes(x=age, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_C, size=0.3, col='green') +
        labs(title='Prevalence of Cancer by Age', y='Prevalence of Cancer', x='Age')
ggplot(cohort, aes(x=age, y=p_hibpe_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_C, size=0.3, col='green') +
        labs(title='Prevalence of High Blood Pressure  by Age', y='Prevalence of Cancer', x='Age')

```

# SmokeStopFull (cohort)

```{r}

# Read in all the data
cohort <- read_dta('output/ELSA_cohort/ELSA_cohort_summary.dta')
SSF_C <- read_dta('output/SmokeStopFull_C/SmokeStopFull_C_summary.dta')

# Generate age var
cohort$age <- (cohort$year - 2012) + 50
SSF_C$age <- (cohort$year - 2012) + 50

# Survival curve
cohort$survival <- cohort$m_endpop_all / cohort$m_endpop_all[1]
SSF_C$survival <- SSF_C$m_endpop_all / SSF_C$m_endpop_all[1]

# Now plot all survival curves together
ggplot(cohort, aes(x=age, y=survival)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_C, size=0.3, col='green') +
        labs(title='Cohort Survival Over Time', y='Survival', x='Age')
# Smoking variables and chronic diseases
ggplot(cohort, aes(x=age, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_C, size=0.3, col='green') +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_C, size=0.3, col='green') +
        labs(title='Prevalence of Smoking by Age', y='Prevalence of Smoking', x='Age')
ggplot(cohort, aes(x=age, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_C, size=0.3, col='green') +
        labs(title='Prevalence of Lung Disease by Age', y='Prevalence of Lung Disease', x='Age')
ggplot(cohort, aes(x=age, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_C, size=0.3, col='green') +
        labs(title='Prevalence of Cancer by Age', y='Prevalence of Cancer', x='Age')


```



# No Smoking Scenario (Population)

```{r}

# Read in all the data
pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')
no_smoke_P <- read_dta('output/CureSmoken_P/CureSmoken_P_summary.dta')

# Plot Average age at death
ggplot(pop, aes(x=year, y=d_age_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_P, size=0.3, col='green') +
        labs(title='Average Age at Death over Time', y='Average age at death', x='Year')
        
# Smoking variables and chronic diseases
ggplot(pop, aes(x=year, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_P, size=0.3, col='green') +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Year')
ggplot(pop, aes(x=year, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_P, size=0.3, col='green') +
        labs(title='Prevalence of Smoking over Time', y='Prevalence of Smoking', x='Year')
ggplot(pop, aes(x=year, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_P, size=0.3, col='green') +
        labs(title='Prevalence of Lung Disease over Time', y='Prevalence of Lung Disease', x='Year')
ggplot(pop, aes(x=year, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=no_smoke_P, size=0.3, col='green') +
        labs(title='Prevalence of Cancer over Time', y='Prevalence of Cancer', x='Year')

```



# SmokeStopFull (Population)

```{r}

# Read in all the data
pop <- read_dta('output/ELSA_Baseline/ELSA_Baseline_summary.dta')
SSF_P <- read_dta('output/SmokeStopFull_P/SmokeStopFull_P_summary.dta')

# Plot Average age at death
ggplot(pop, aes(x=year, y=d_age_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_P, size=0.3, col='green') +
        labs(title='Average Age at Death over Time', y='Average age at death', x='Year')
        
# Smoking variables and chronic diseases
ggplot(pop, aes(x=year, y=n_smoke_stop_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_P, size=0.3, col='green') +
        labs(title='Smoke Stop', y='# Stopped Smoking', x='Year')
ggplot(pop, aes(x=year, y=p_smoken_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_P, size=0.3, col='green') +
        labs(title='Prevalence of Smoking over Time', y='Prevalence of Smoking', x='Year')
ggplot(pop, aes(x=year, y=p_lunge_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_P, size=0.3, col='green') +
        labs(title='Prevalence of Lung Disease over Time', y='Prevalence of Lung Disease', x='Year')
ggplot(pop, aes(x=year, y=p_cancre_all)) +
        geom_line(col='black', size=0.3) +
        geom_line(data=SSF_P, size=0.3, col='green') +
        labs(title='Prevalence of Cancer over Time', y='Prevalence of Cancer', x='Year')

```